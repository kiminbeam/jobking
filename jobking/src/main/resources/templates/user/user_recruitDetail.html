<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" type="text/css" href="/css/style.css">
<script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
	.link-icon { position: relative; display: inline-block; width: auto; font-size: 14px; font-weight: 500; color: #333; margin-right: 10px; padding-top: 50px; }
	.link-icon.twitter { background-image: url(/images/icon/icon-twitter.png); background-repeat: no-repeat; }
	.link-icon.facebook { background-image: url(/images/icon/icon-facebook.png); background-repeat: no-repeat; } 
	.link-icon.kakao { background-image: url(/images/icon/icon-kakao.png); background-repeat: no-repeat; }
     #chart-container {
         height: 500px;
     }

</style>
</head>
<body>
	<header>
		<div th:replace="~{/fragments/nav.html :: fragment-nav}"></div>
	</header>
	<main>
		<div th:include="~{/fragments/sidebar.html :: fragment-sidebar}"></div>
		<div>
		
		
		
<!-- 1. ë³µì‚¬(ë²„íŠ¼) url ë³µì‚¬, ê³µìœ  ê¸°ëŠ¥ -->
<!-- 2. ì±„ìš©ì œëª©/ ê¸°ì—…ëª…/ ì ‘ìˆ˜ê¸°ê°„ ë“± -->
<!-- 3. ì ‘ìˆ˜ê¸°ê°„: D-day ê¸°ëŠ¥ (ì ‘ìˆ˜ê¸°ê°„ì´ ëª‡ ì¼ ë‚¨ì•˜ëŠ”ì§€?) -->
<!-- 4. ê´€ì‹¬ê¸°ì—… êµ¬ë…(Button) -->
<!-- 5. ì±„ìš©ê³µê³  ìŠ¤í¬ë©(B) -->
<!-- 6. ì±„ìš©ê³µê³  ìƒì„¸ ì •ë³´(imgë„ ê°€ëŠ¥ ) -->
<!-- 7. ê¸°ì—…ìì²´ ì´ë ¥ì„œ ì¡´ì¬ì‹œ => ì´ë ¥ì„œ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼/ ì—†ì„ì‹œ ì±„ìš©ì‚¬ì´íŠ¸ì— ì €ì¥ëœ ì´ë ¥ì„œëª©ë¡ë³´ì´ê¸° (url2)-->
<!-- 8. ê´€ë ¨í‚¤ì›Œë“œ(ê¸°ì—…ì´ ë“±ë¡í•´ë†“ì€ ê´€ë ¨ì—…ë¬´) view -->
<!-- 9. ì§€ì›ì í˜„í™© (ê·¸ë˜í”„ë‚˜ ì¸ì›ìˆ˜ë§Œ ë³´ì´ë„ë¡) -->
<!-- 10. ì¶”ì²œ ì¼ìë¦¬ (5ê°œ í‘œì‹œ;) -->
			<div id="copyBtn" onclick="copyToClipboard()"><img style="width:30px; height:30px;" th:src="@{/images/icon/copy.png}" alt="copyBtn"></div>
			<div>
				<a id="btnTwitter" class="link-icon twitter" href="javascript:shareTwitter();">íŠ¸ìœ„í„°</a>
				<a id="btnFacebook" class="link-icon facebook" href="javascript:shareFacebook();">í˜ì´ìŠ¤ë¶</a>    
				<a id="btnKakao" class="link-icon kakao" href="javascript:shareKakao();">ì¹´ì¹´ì˜¤í†¡</a>
			</div>
			<h1>ì ‘ìˆ˜ê¸°ê°„ d-day : <span id="dDay"></span></h1>
			<div id="likeContainer">
			</div>
			<div id="scrapContainer">
			</div>
			<div id="applyContainer">
			</div>
			

			<div id="chart-container">
        		<canvas id="chart"></canvas>
    		</div>
			
			<div class="jobad header">
				<h3>[[${jobad.company.cname}]]</h3>
				<h3>[[${avgReview}]]</h3>
				<h1>[[${jobad.wantedTitle}]]</h1>
			</div>
			<div class="jobad company_info">
				<table>
					<tr>
						<th>ëŒ€í‘œìëª…</th>
						<td>[[${jobad.company.ceo}]]</td>
						<th>ì—…ì¢…</th>
						<td>[[${jobad.company.sector}]]</td>
					</tr>
					<tr>
						<th>ê¸°ì—…ê·œëª¨</th>
						<td>[[${jobad.company.size}]]</td>
						<th>ì£¼ìš”ì‚¬ì—…</th>
						<td>[[${jobad.company.major}]]</td>
					</tr>
					<tr>
						<th>ì—°ë§¤ì¶œì•¡</th>
						<td>[[${jobad.company.yrSales}]]</td>
						<th>ê¸°ì—…ì£¼ì†Œ</th>
						<td>[[${jobad.company.caddr}]]</td>
						
					</tr>
				</table>
			</div>
			<div class="jobad main">
				<table>
					<tr>
						<th>ì§ë¬´</th>
						<td>[[${jobad.position1}]], [[${jobad.position2}]]</td>
						<th>ì—…ì¢…</th>
						<td>[[${jobad.sector1}]], [[${jobad.sector2}]]</td>
						<th>ìƒì„¸ê³µê³ </th>
						<td>
							<ul>
								<li th:each="jobCont : ${jobCont}">ğŸ“Œ [[${jobCont}]] </li>
							</ul>
						</td>
					</tr>
					<tr>
						<th>ì±„ìš© ë§ˆê°</th>
						<td>[[${jobad.receiptCloseDt}]]</td>
						<th>ê·¼ë¬´í˜•íƒœ</th>
						<td>[[${jobad.empTpNm}]]</td>
					</tr>
					<tr>
						<th>ì±„ìš©ì¸ì›</th>
						<td>[[${jobad.collectPsncnt}]]</td>
						<th>ì—°ë´‰</th>
						<td>[[${jobad.salTpNm}]]</td>
					</tr>
					<tr>
						<th>ìµœì†Œí•™ë ¥</th>
						<td>[[${jobad.minEdubglcd}]]</td>
					</tr>
					<tr>
						<th>ë³‘ì—­íŠ¹ë¡€ì±„ìš©í¬ë§</th>
						<td>[[${jobad.mltsvcExcHope}]]</td>
						<th>í•„ìš”ìŠ¤í‚¬</th>
						<td>
							<ul>
								<li th:each="jobCont : ${jobSkill}">ğŸ“Œ [[${jobSkill}]] </li>
							</ul>
						</td>
					</tr>
					<tr>
						<th>ì ‘ìˆ˜ë°©ë²•</th>
						<td>[[${jobad.rcptMthd}]]</td>
						<th>ê·¼ë¬´ì§€ì—­</th>
						<td>[[${jobad.region1}]], [[${jobad.region2}]]</td>
					</tr>
					<tr>
						<th>ê·¼ë¬´ì‹œê°„</th>
						<td>[[${jobad.WkdWkhCnt}]]</td>
						<th>í‡´ì§ê¸ˆì—¬ë¶€</th>
						<td>[[${jobad.retirepay}]]</td>
					</tr>
					<tr>
						<th>ê¸°íƒ€ë³µë¦¬í›„ìƒ</th>
						<td>[[${jobad.etcWelfare}]]</td>
						<th>íšŒì‚¬ì†Œê°œì²¨ë¶€íŒŒì¼</th>
						<td>[[${jobad.attachFileUrl}]]</td>
					</tr>
					<tr>
						<th>ì œì¶œì„œë¥˜ì–‘ì‹ì²¨ë¶€</th>
						<td>[[${jobad.attachFileUrl2}]]</td>
					</tr>
					<tr>
						<th>ì„ê¸ˆí˜•íƒœ</th>
						<td>[[${jobad.salTpCd}]]</td>
						<th>ë‹´ë‹¹ìëª…</th>
						<td>[[${jobad.empName}]]</td>
					</tr>
					<tr>
						<th>ë‹´ë‹¹ì ì´ë©”ì¼</th>
						<td>[[${jobad.empEmail}]]</td>
						<th>ë‹´ë‹¹ì ë²ˆí˜¸</th>
						<td>[[${jobad.empTel}]]</td>
					</tr>
				</table>12opr[]\itq	y                  
				í‚¤ì›Œë“œ : <ul><li th:each="jobKeyword : ${jobKeyword}">ğŸ“Œ [[${jobKeyword}]] </li></ul>
			</div>
		</div>
	</main>
<script th:inline="javascript">
	const dDay = document.querySelector("#dDay");
	const targetDate = [[${jobad.receiptCloseDt}]];
	const regDate = [[${jobad.regdate}]];
	
	//ìŠ¤í¬ë©ë²„íŠ¼ ì²˜ë¦¬
	if([[${scrap == false}]]){
		document.querySelector("#scrapContainer").innerHTML="<div onclick='scrapJobad()'><img style='width:30px; height:30px;' src='/images/icon/save.png' alt='saveBtn'></div>";
	}else if([[${scrap == true}]]){
		document.querySelector("#scrapContainer").innerHTML="<div onclick='scrapJobad()'><img style='width:30px; height:30px;' src='/images/icon/save_full.png' alt='saveFullBtn'></div>";
	}
	//êµ¬ë…ë²„íŠ¼ ì²˜ë¦¬
	if([[${interest == false}]]){
		document.querySelector("#likeContainer").innerHTML="<div onclick='likeTheCom()'><img style='width:30px; height:30px;' src='/images/icon/heart.png' alt='heartBtn'></div>";
	}else if([[${interest == true}]]){
		document.querySelector("#likeContainer").innerHTML="<div onclick='likeTheCom()'><img style='width:30px; height:30px;' src='/images/icon/heart_full.png' alt='heartFullBtn'></div>";
	}
	
//ìì²´ ì–‘ì‹ ì—†ìœ¼ë©´ ì‚¬ì´íŠ¸ ë‚´ ì§€ì›ì„œ ì œì¶œ, ìˆìœ¼ë©´ ì–‘ì‹ë‹¤ìš´ë°›ëŠ” ë²„íŠ¼ ë³´ì—¬ì£¼ê¸°
	if([[${jobad.attachFileUrl2 == ""}]]){
		document.querySelector("#applyContainer").innerHTML="<button onclick='openPopUp()'>ì§€ì›ì„œ ì œì¶œí•˜ê¸°</button>"
	}else{
		document.querySelector("#applyContainer").innerHTML="<button id='downloadFormBtn'>ì§€ì›ì„œ ì–‘ì‹ ë‹¤ìš´ë°›ê¸°</button>"
	}
	//ì‚¬ì´íŠ¸ë‚´ ì§€ì›ì„œ ì œì¶œì‹œ íŒì—…ì„ ë„ì›Œì„œ ì–´ë–¤ ì´ë ¥ì„œë¥¼ ê³¨ë¼ì„œ ë‚¼ê±´ì§€ ì„ íƒí•˜ê²Œ í•˜ê¸°
	function openPopUp(){
		 window.open("http://localhost:8093/user/user_resumePick?jno="+[[${jobad.jno}]], "íŒì—… ì°½", "width=600,height=400");
	}
	// ìì²´ ì–‘ì‹ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­ ì‹œ ì²˜ë¦¬
	document.querySelector("#downloadFormBtn").addEventListener("click", function() {
	    // ë§Œì•½ attachFileUrl2ê°€ ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹ˆë¼ë©´, ì¦‰ ì–‘ì‹ì´ ì¡´ì¬í•œë‹¤ë©´
	    if ([[${jobad.attachFileUrl2 == ""}]]) {
	        // íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
	        const downloadLink = document.createElement("a");
	        downloadLink.href = [[${jobad.attachFileUrl2}]];
	        // íŒŒì¼ëª… ì„¤ì •
	        downloadLink.download = "ì§€ì›ì„œ_ì–‘ì‹.pdf"; // ë‹¤ìš´ë¡œë“œë˜ëŠ” íŒŒì¼ëª…
	        // ë§í¬ í´ë¦­í•˜ì—¬ ë‹¤ìš´ë¡œë“œ ì‹œì‘
	        downloadLink.click();
	    } else {
	        // ì–‘ì‹ì´ ì—†ì„ ê²½ìš°ì— ëŒ€í•œ ì²˜ë¦¬
	        alert("ì–‘ì‹ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
	    }
	});
	
	function scrapJobad(){
		 const xhttp = new XMLHttpRequest();
		 xhttp.onload = function() {
			 if(this.responseText == "added"){
				 alert("ì„±ê³µì ìœ¼ë¡œ ê³µê³ ë¥¼ ì°œí–ˆìŠµë‹ˆë‹¤")
				 //ë²„íŠ¼ ìƒ‰ì¹ í•œê±°ë¡œ ë°”ê¿”ì£¼ê¸°
				 document.querySelector("#scrapContainer").innerHTML="<div onclick='scrapJobad()'><img style='width:30px; height:30px;' src='/images/icon/save_full.png' alt='saveFullBtn'></div>";
			 }else{
				 if(confirm("ì •ë§ í•´ë‹¹ ê³µê³ ë¥¼ ì°œ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
					 //ë¹„ì–´ìˆëŠ” ë²„íŠ¼ìœ¼ë¡œ ë°”ê¿”ì£¼ê¸°
					 document.querySelector("#scrapContainer").innerHTML="<div onclick='scrapJobad()'><img style='width:30px; height:30px;' src='/images/icon/save.png' alt='saveBtn'></div>";
				 }
			 }
		 }
		  xhttp.open("GET", "/user/scrapJobad?jno="+[[${jobad.jno}]], true);
		  xhttp.send();
	}
	function likeTheCom(){
		 const xhttp = new XMLHttpRequest();
		 xhttp.onload = function() {
			 if(this.responseText == "added"){
				 alert("ì„±ê³µì ìœ¼ë¡œ í•´ë‹¹ê¸°ì—…ì„ êµ¬ë… í–ˆìŠµë‹ˆë‹¤")
				 //ë²„íŠ¼ ìƒ‰ì¹ í•œê±°ë¡œ ë°”ê¿”ì£¼ê¸°
				 document.querySelector("#likeContainer").innerHTML="<div onclick='likeTheCom()'><img style='width:30px; height:30px;' src='/images/icon/heart_full.png' alt='heartFullBtn'></div>";
				
			 }else{
				 if(confirm("ì •ë§ í•´ë‹¹ ê¸°ì—…ì„ êµ¬ë… ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
					 //ë¹„ì–´ìˆëŠ” ë²„íŠ¼ìœ¼ë¡œ ë°”ê¿”ì£¼ê¸°
					 document.querySelector("#likeContainer").innerHTML="<div onclick='likeTheCom()'><img style='width:30px; height:30px;' src='/images/icon/heart.png' alt='heartBtn'></div>";
				 }
			 }
		 }
		  xhttp.open("GET", "/user/likeTheCom?cid="+[[${jobad.company.cid}]], true);
		  xhttp.send();
	}
	
	
	
	  // ê·¸ë˜í”„ ì´ˆê¸°í™”
    document.addEventListener("DOMContentLoaded", function() {
        var chartContainer = document.getElementById('chart-container');
        var chartCanvas = document.getElementById('chart');
        var ctx = chartCanvas.getContext('2d');
        
        var chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ["ê³µê³ ë“±ë¡ì¼", "ì˜¤ëŠ˜"],
                datasets: [{
                    label: 'ì‹¤ì‹œê°„ ì§€ì›ììˆ˜ í˜„í™©',
                    data: [1, 50],
                    borderColor: 'blue',
                    borderWidth: 1,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        display: true,
                        ticks: {
                            autoSkip: true,
                            maxTicksLimit: 10
                        }
                    },
                    y: {
                        display: true,
                        suggestedMin: 0,
                        suggestedMax: 100
                    }
                }
            }
        });
    });

	function calcDday(){
		 // ì£¼ì–´ì§„ ë‚ ì§œì™€ í˜„ì¬ ë‚ ì§œ ê°„ì˜ ì°¨ì´ ê³„ì‚°
	    const oneDay = 24 * 60 * 60 * 1000; // í•˜ë£¨ë¥¼ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ í‘œí˜„
	    const today = new Date(); // í˜„ì¬ ë‚ ì§œ
	    const target = new Date(targetDate); // ì£¼ì–´ì§„ ë‚ ì§œ

	    // ì£¼ì–´ì§„ ë‚ ì§œì™€ í˜„ì¬ ë‚ ì§œ ê°„ì˜ ì°¨ì´ë¥¼ ì¼ ë‹¨ìœ„ë¡œ ê³„ì‚°
	    const diffDays = Math.round((target - today) / oneDay);

	    return diffDays;
	}
	const dday = calcDday(targetDate);
	dDay.innerHTML=dday;
	
	function copyToClipboard() {
	    var t = document.createElement("textarea");
	    document.body.appendChild(t);
	    t.value = window.location.href;
	    t.select();
	    document.execCommand('copy');
	    document.body.removeChild(t);
	};
    document.querySelector("#copyBtn").addEventListener("click", function() {
	      copyToClipboard(window.location.href);
	      alert('ì£¼ì†Œë¥¼ ë³µì‚¬í•˜ì˜€ìŠµë‹ˆë‹¤');
	    })

	function shareTwitter() {
	    const sendText = [[${jobad.wantedTitle}]]; // ì „ë‹¬í•  í…ìŠ¤íŠ¸
	    const sendUrl = window.location.href; // ì „ë‹¬í•  URL
	    window.open("https://twitter.com/intent/tweet?text=" + sendText + "&url=" + sendUrl);
	}
	function shareFacebook() {
	    var sendUrl = window.location.href; // ì „ë‹¬í•  URL
	    window.open("http://www.facebook.com/sharer/sharer.php?u=" + sendUrl);
	}
	function shareKakao() {
		  // ì‚¬ìš©í•  ì•±ì˜ JavaScript í‚¤ ì„¤ì •
		  Kakao.init('a65924b5ad21649d69b934fcd8c1eeea');
		  // ì¹´ì¹´ì˜¤ë§í¬ ë²„íŠ¼ ìƒì„±
		  Kakao.Link.createDefaultButton({
		    container: '#btnKakao', // ì¹´ì¹´ì˜¤ê³µìœ ë²„íŠ¼ID
		    objectType: 'feed',
		    content: {
		      title: [[${jobad.wantedTitle}]], // ë³´ì—¬ì§ˆ ì œëª©
		      description: "ì¡ì™•ì±„ìš©ê³µê³ ", // ë³´ì—¬ì§ˆ ì„¤ëª…
		      imageUrl: window.location.href, // ì½˜í…ì¸  URL
		      link: {
		         mobileWebUrl: window.location.href,
		         webUrl: window.location.href
		      }
		    }
		  });
		}
</script>
</body>
</html>